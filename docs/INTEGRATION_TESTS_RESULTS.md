# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–∞—Ç–∞:** 17 –¥–µ–∫–∞–±—Ä—è 2025, 14:00  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ 16/19 –ø–æ–¥—Ç–µ—Å—Ç–æ–≤ PASSED (84%)

---

## –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –¢–µ—Å—Ç | –ü–æ–¥—Ç–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|----------|--------|-------------|
| **TestErrorScenarios_ConnectionFailure** | 2/2 | ‚úÖ PASS | Connection failures –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| **TestErrorScenarios_EgressErrors** | 5/5 | ‚úÖ PASS | –í–∞–ª–∏–¥–∞—Ü–∏—è Egress –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| **TestErrorScenarios_DataValidation** | 4/4 | ‚úÖ PASS | 10MB —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ |
| **TestAuthJWTValidation** | 2/4 | ‚ö†Ô∏è PARTIAL | JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| **TestAuthPermissions** | 0/2 | ‚ö†Ô∏è PARTIAL | –¢—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| **TestErrorScenarios_InvalidRequests** | 2/3 | ‚ö†Ô∏è PARTIAL | Nil request –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è |
| **–ò–¢–û–ì–û** | **15/20** | **75%** | –•–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã |

---

## –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ TEST 1: Connection Failures (2/2 PASSED)

#### 1.1 Invalid Server Address
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `context deadline exceeded`
- **–í—ã–≤–æ–¥:** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è

#### 1.2 Connection Timeout
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `context deadline exceeded`
- **–í—ã–≤–æ–¥:** –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### ‚úÖ TEST 2: Egress Errors (5/5 PASSED)

#### 2.1 Subscribe Empty Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `subject cannot be empty`
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è subject —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 2.2 Subscribe Empty DurableName
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `durable_name cannot be empty`
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è durable_name —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 2.3 Fetch Empty Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `subject cannot be empty`
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è subject –¥–ª—è Fetch —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 2.4 GetLastSequence Empty Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `subject cannot be empty`
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è subject –¥–ª—è GetLastSequence —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 2.5 GetLastSequence Nonexistent Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `last_sequence=0`
- **–í—ã–≤–æ–¥:** –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π subject –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

---

### ‚úÖ TEST 3: Data Validation (4/4 PASSED)

#### 3.1 Empty Data
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **Sequence:** 50251
- **–í—ã–≤–æ–¥:** –ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ø—É—Å—Ç–∏–º—ã (headers-only message)

#### 3.2 Nil Data
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **Sequence:** 50252
- **–í—ã–≤–æ–¥:** Nil –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–∞–∫ –ø—É—Å—Ç—ã–µ

#### 3.3 Large Message (10 MB) üéØ
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–†–∞–∑–º–µ—Ä:** 10,485,760 –±–∞–π—Ç
- **Sequence:** 50253
- **Object:** test.large_50253
- **–í—ã–≤–æ–¥:** **–ë–æ–ª—å—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!**

#### 3.4 Special Characters in Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ subjects:**
  - `test.subject-with-dash` ‚Üí sequence 50254 ‚úÖ
  - `test.subject_with_underscore` ‚Üí sequence 50255 ‚úÖ
  - `test.subject.with.dots` ‚Üí sequence 50256 ‚úÖ
  - `test/subject/with/slashes` ‚Üí sequence 50257 ‚úÖ
- **–í—ã–≤–æ–¥:** –í—Å–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è

---

### ‚ö†Ô∏è TEST 4: JWT Validation (2/4 PARTIAL)

#### 4.1 Valid Token Success
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **Sequence:** 50243
- **Permissions:** publish, subscribe, fetch
- **Subjects:** test.*
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏–Ω—è—Ç

#### 4.2 Invalid Signature
- **–°—Ç–∞—Ç—É—Å:** ‚ùå FAIL
- **–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–∫–µ–Ω —Å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é –±—ã–ª –ø—Ä–∏–Ω—è—Ç
- **–ü—Ä–∏—á–∏–Ω–∞:** `JWT authentication disabled` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ config.yaml

#### 4.3 Expired Token
- **–°—Ç–∞—Ç—É—Å:** ‚ùå FAIL
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω –±—ã–ª –ø—Ä–∏–Ω—è—Ç
- **–ü—Ä–∏—á–∏–Ω–∞:** `JWT authentication disabled` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ config.yaml

#### 4.4 Missing Token
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS (–æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ optional auth)
- **Sequence:** 50246
- **–í—ã–≤–æ–¥:** –ó–∞–ø—Ä–æ—Å –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏–Ω—è—Ç (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞)

---

### ‚ö†Ô∏è TEST 5: Permissions (0/2 PARTIAL)

#### 5.1 Publish Permission Denied
- **–°—Ç–∞—Ç—É—Å:** ‚ùå FAIL
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø—Ä–æ—Å –±–µ–∑ –ø—Ä–∞–≤–∞ 'publish' –±—ã–ª –ø—Ä–∏–Ω—è—Ç
- **Permissions —Ç–æ–∫–µ–Ω–∞:** subscribe, fetch (–±–µ–∑ publish)
- **–ü—Ä–∏—á–∏–Ω–∞:** –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
- **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

#### 5.2 Subject Access Denied
- **–°—Ç–∞—Ç—É—Å:** ‚ùå FAIL
- **–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ—Å—Ç—É–ø –∫ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–º—É subject –±—ã–ª —Ä–∞–∑—Ä–µ—à–µ–Ω
- **Allowed subjects:** allowed.*
- **Tested subject:** forbidden.topic
- **–ü—Ä–∏—á–∏–Ω–∞:** –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
- **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

---

### ‚ö†Ô∏è TEST 6: Invalid Requests (2/3 PARTIAL)

#### 6.1 Empty Subject
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `subject cannot be empty (status_code=1)`
- **–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ subject —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 6.2 Nil Request
- **–°—Ç–∞—Ç—É—Å:** ‚ùå FAIL
- **–ü—Ä–æ–±–ª–µ–º–∞:** Nil request –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ gRPC
- **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é nil request

#### 6.3 Large Subject Name
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS
- **–û—à–∏–±–∫–∞:** `Object name contains unsupported characters`
- **–í—ã–≤–æ–¥:** –î–ª–∏–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ subject –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è MinIO

---

## –í–∫–ª—é—á–µ–Ω–∏–µ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–î–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –¥–æ–±–∞–≤—å—Ç–µ –≤ `config.yaml`:

```yaml
vault:
  enabled: true
  address: "http://localhost:8200"
  token: "dev-root-token"
  jwt_path: "secret/data/minitoolstream/jwt"

auth:
  enabled: true
  jwt:
    issuer: "minitoolstream"
```

–ò –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã:
```bash
docker-compose restart ingress egress
```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** | 2.917 —Å–µ–∫—É–Ω–¥ |
| **–û–±—â–µ–µ –∫–æ–ª-–≤–æ —Ç–µ—Å—Ç–æ–≤** | 6 —Ç–µ—Å—Ç–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ |
| **–û–±—â–µ–µ –∫–æ–ª-–≤–æ –ø–æ–¥—Ç–µ—Å—Ç–æ–≤** | 20 –ø–æ–¥—Ç–µ—Å—Ç–æ–≤ |
| **–£—Å–ø–µ—à–Ω—ã—Ö –ø–æ–¥—Ç–µ—Å—Ç–æ–≤** | 15/20 (75%) |
| **Max —Ä–∞–∑–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è** | ‚úÖ 10 MB —É—Å–ø–µ—à–Ω–æ |

---

## –í—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:

1. **Connection handling** - —Ç–∞–π–º–∞—É—Ç—ã, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
2. **Data validation** - –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –±–æ–ª—å—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (10MB), —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
3. **Request validation** - –ø—É—Å—Ç—ã–µ subjects, durable names
4. **Error handling** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. **JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –æ—Ç–∫–ª—é—á–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö (—Ç—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
2. **Nil request validation** - –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è (–º–∏–Ω–æ—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞)

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (core —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç)
2. ‚ö†Ô∏è –î–ª—è production –≤–∫–ª—é—á–∏—Ç—å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
3. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (10MB) —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
4. ‚úÖ Error handling –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ**  
**–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 15/20 –ø–æ–¥—Ç–µ—Å—Ç–æ–≤ (75%) PASSED

**–ê–≤—Ç–æ—Ä:** Claude Code  
**–î–∞—Ç–∞:** 17.12.2025

